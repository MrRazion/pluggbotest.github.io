<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Games Hub</title>
    <script src="https://telegram.org/js/telegram-web-app.js?59"></script>
    <style>
        :root {
            --tg-theme-bg-color: #ffffff;
            --tg-theme-text-color: #000000;
            --tg-theme-link-color: #3390ec;
            --tg-theme-button-color: #3390ec;
            --tg-theme-button-text-color: #ffffff;
            --tg-theme-secondary-bg-color: #f5f5f5;
            --tg-theme-section-bg-color: #ffffff;
            --tg-theme-accent-text-color: #3390ec;
            --tg-theme-destructive-text-color: #ec3944;
            --tg-theme-section-separator-color: #e0e0e0;
        }

        [data-theme="dark"] {
            --tg-theme-bg-color: #1a1a1a;
            --tg-theme-text-color: #ffffff;
            --tg-theme-link-color: #3390ec;
            --tg-theme-button-color: #3390ec;
            --tg-theme-button-text-color: #ffffff;
            --tg-theme-secondary-bg-color: #2a2a2a;
            --tg-theme-section-bg-color: #1a1a1a;
            --tg-theme-accent-text-color: #3390ec;
            --tg-theme-destructive-text-color: #ec3944;
            --tg-theme-section-separator-color: #3a3a3a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            min-height: 100vh;
            padding: var(--tg-safe-area-inset-top) var(--tg-safe-area-inset-right) var(--tg-safe-area-inset-bottom) var(--tg-safe-area-inset-left);
            transition: background-color 0.3s ease;
        }

        .app-container {
            max-width: 100%;
            padding: 16px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid var(--tg-theme-section-separator-color);
            margin-bottom: 16px;
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--tg-theme-text-color);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3390ec, #6c5ce7);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
        }

        .tabs-container {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 4px;
            scrollbar-width: none;
        }

        .tabs-container::-webkit-scrollbar {
            display: none;
        }

        .tab {
            padding: 8px 16px;
            border-radius: 8px;
            background-color: var(--tg-theme-secondary-bg-color);
            color: var(--tg-theme-text-color);
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
            border: 2px solid transparent;
        }

        .tab.active {
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border-color: var(--tg-theme-button-color);
        }

        .game-card {
            background-color: var(--tg-theme-section-bg-color);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            border: 1px solid var(--tg-theme-section-separator-color);
        }

        .game-header {
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            border-bottom: 1px solid var(--tg-theme-section-separator-color);
        }

        .game-icon {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            background: linear-gradient(135deg, #3390ec, #6c5ce7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: bold;
            color: white;
        }

        .game-info {
            flex: 1;
        }

        .game-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
            color: var(--tg-theme-text-color);
        }

        .game-meta {
            display: flex;
            gap: 12px;
            font-size: 14px;
            color: var(--tg-theme-accent-text-color);
            margin-bottom: 4px;
        }

        .game-description {
            font-size: 15px;
            line-height: 1.5;
            color: var(--tg-theme-text-color);
            opacity: 0.9;
            margin-top: 12px;
        }

        .screenshots-section {
            padding: 16px;
            border-top: 1px solid var(--tg-theme-section-separator-color);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--tg-theme-text-color);
        }

        .screenshots-container {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
            scrollbar-width: none;
        }

        .screenshots-container::-webkit-scrollbar {
            display: none;
        }

        .screenshot {
            min-width: 120px;
            height: 80px;
            border-radius: 12px;
            background: linear-gradient(135deg, #3498db, #8e44ad);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            text-align: center;
            padding: 4px;
        }

        .whats-new-section {
            padding: 16px;
            border-top: 1px solid var(--tg-theme-section-separator-color);
        }

        .update-log {
            background-color: var(--tg-theme-secondary-bg-color);
            border-radius: 12px;
            padding: 12px;
            margin-top: 8px;
            font-size: 14px;
            line-height: 1.5;
            color: var(--tg-theme-text-color);
        }

        .download-section {
            padding: 16px;
            border-top: 1px solid var(--tg-theme-section-separator-color);
        }

        .download-button {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s ease;
        }

        .download-button:hover {
            opacity: 0.9;
        }

        .download-button:active {
            transform: scale(0.98);
        }

        .progress-container {
            margin-top: 8px;
            height: 4px;
            background-color: var(--tg-theme-secondary-bg-color);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--tg-theme-button-color);
            border-radius: 2px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .loader {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loader-spinner {
            width: 30px;
            height: 30px;
            border: 3px solid rgba(51, 144, 236, 0.3);
            border-radius: 50%;
            border-top-color: var(--tg-theme-button-color);
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            background-color: var(--tg-theme-button-color);
            color: white;
            font-weight: 500;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background-color: var(--tg-theme-destructive-text-color);
        }

        @media (max-width: 480px) {
            .app-container {
                padding: 12px;
            }
            
            .header {
                padding: 12px 0;
            }
            
            .game-icon {
                width: 60px;
                height: 60px;
                font-size: 32px;
            }
            
            .game-title {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <div class="header-title">Games Hub</div>
            <div class="user-avatar">G</div>
        </div>

        <div class="tabs-container">
            <div class="tab active" data-tab="minecraft">Minecraft</div>
            <div class="tab" data-tab="brawlstars">Brawl Stars</div>
            <div class="tab" data-tab="standoff">Standoff 2</div>
        </div>

        <div id="minecraft-content" class="tab-content">
            <div class="game-card">
                <div class="game-header">
                    <div class="game-icon">ùêå</div>
                    <div class="game-info">
                        <div class="game-title">Minecraft</div>
                        <div class="game-meta">
                            <span>Size: 158.2 MB</span>
                            <span>‚Ä¢</span>
                            <span>Updated: Nov 5, 2025</span>
                        </div>
                    </div>
                </div>

                <div class="game-description">
                    Explore infinite worlds and build everything from the simplest of homes to the grandest of castles. Play in creative mode with unlimited resources or mine deep into the world in survival mode.
                </div>

                <div class="screenshots-section">
                    <div class="section-title">Screenshots</div>
                    <div class="screenshots-container">
                        <div class="screenshot">Forest Adventure</div>
                        <div class="screenshot">Ocean Explorer</div>
                        <div class="screenshot">Mountain Base</div>
                        <div class="screenshot">Creative Build</div>
                        <div class="screenshot">Nether Portal</div>
                    </div>
                </div>

                <div class="whats-new-section">
                    <div class="section-title">What's New</div>
                    <div class="update-log">
                        ‚Ä¢ Added new Caves & Cliffs features<br>
                        ‚Ä¢ Improved performance and stability<br>
                        ‚Ä¢ Fixed several bugs related to world generation<br>
                        ‚Ä¢ Added new achievements and trophies<br>
                        ‚Ä¢ Optimized for mobile devices
                    </div>
                </div>

                <div class="download-section">
                    <button class="download-button" id="minecraft-download">
                        <span>Download Minecraft</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="brawlstars-content" class="tab-content hidden">
            <div class="game-card">
                <div class="game-header">
                    <div class="game-icon" style="background: linear-gradient(135deg, #ff9800, #e65100);">ùêÅ</div>
                    <div class="game-info">
                        <div class="game-title">Brawl Stars</div>
                        <div class="game-meta">
                            <span>Size: 245.7 MB</span>
                            <span>‚Ä¢</span>
                            <span>Updated: Nov 1, 2025</span>
                        </div>
                    </div>
                </div>

                <div class="game-description">
                    Fast-paced 3v3 multiplayer and battle royale made for mobile! Play with friends or solo across a variety of game modes in under three minutes.
                </div>

                <div class="screenshots-section">
                    <div class="section-title">Screenshots</div>
                    <div class="screenshots-container">
                        <div class="screenshot">Brawler Showdown</div>
                        <div class="screenshot">Gem Grab Mode</div>
                        <div class="screenshot">Brawl Ball</div>
                        <div class="screenshot">Heist Game Mode</div>
                        <div class="screenshot">New Brawlers</div>
                    </div>
                </div>

                <div class="whats-new-section">
                    <div class="section-title">What's New</div>
                    <div class="update-log">
                        ‚Ä¢ New Brawler: Surge<br>
                        ‚Ä¢ Balance changes to existing brawlers<br>
                        ‚Ä¢ New map variants added<br>
                        ‚Ä¢ Improved matchmaking system<br>
                        ‚Ä¢ Bug fixes and performance improvements
                    </div>
                </div>

                <div class="download-section">
                    <button class="download-button" id="brawlstars-download">
                        <span>Download Brawl Stars</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="standoff-content" class="tab-content hidden">
            <div class="game-card">
                <div class="game-header">
                    <div class="game-icon" style="background: linear-gradient(135deg, #e53935, #d32f2f);">ùêí</div>
                    <div class="game-info">
                        <div class="game-title">Standoff 2</div>
                        <div class="game-meta">
                            <span>Size: 1.2 GB</span>
                            <span>‚Ä¢</span>
                            <span>Updated: Oct 28, 2025</span>
                        </div>
                    </div>
                </div>

                <div class="game-description">
                    Standoff 2 is a dynamic first-person shooter that perfectly captures the spirit of Counter-Strike. Choose your favorite game mode and map, and enjoy the adrenaline rush of intense firefights.
                </div>

                <div class="screenshots-section">
                    <div class="section-title">Screenshots</div>
                    <div class="screenshots-container">
                        <div class="screenshot">Terrorist Hunt</div>
                        <div class="screenshot">Weapon Skins</div>
                        <div class="screenshot">Bomb Defusal</div>
                        <div class="screenshot">Sniper Duel</div>
                        <div class="screenshot">New Maps</div>
                    </div>
                </div>

                <div class="whats-new-section">
                    <div class="section-title">What's New</div>
                    <div class="update-log">
                        ‚Ä¢ New weapon: AK-47 Blood Moon<br>
                        ‚Ä¢ Two new maps: Nightclub and Subway<br>
                        ‚Ä¢ Improved weapon balancing<br>
                        ‚Ä¢ Added new skin cases<br>
                        ‚Ä¢ Optimized graphics for low-end devices
                    </div>
                </div>

                <div class="download-section">
                    <button class="download-button" id="standoff-download">
                        <span>Download Standoff 2</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="loader" id="loader">
            <div class="loader-spinner"></div>
            <div class="loader-text">Preparing download...</div>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
        </div>
    </div>

    <div class="notification" id="notification">Download started!</div>

    <script>
        // Initialize Telegram WebApp
        if (window.Telegram && Telegram.WebApp) {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            
            // Apply theme settings
            applyTheme(telegram.themeParams);
            
            // Listen for theme changes
            Telegram.WebApp.onEvent('themeChanged', function() {
                applyTheme(Telegram.WebApp.themeParams);
            });
            
            // Safe area insets
            document.body.style.paddingTop = Telegram.WebApp.safeAreaInset.top + 'px';
            document.body.style.paddingBottom = Telegram.WebApp.safeAreaInset.bottom + 'px';
            document.body.style.paddingLeft = Telegram.WebApp.safeAreaInset.left + 'px';
            document.body.style.paddingRight = Telegram.WebApp.safeAreaInset.right + 'px';
        }

        function applyTheme(themeParams) {
            // Apply theme colors from Telegram
            if (themeParams) {
                document.documentElement.style.setProperty('--tg-theme-bg-color', themeParams.bg_color || '#ffffff');
                document.documentElement.style.setProperty('--tg-theme-text-color', themeParams.text_color || '#000000');
                document.documentElement.style.setProperty('--tg-theme-link-color', themeParams.link_color || '#3390ec');
                document.documentElement.style.setProperty('--tg-theme-button-color', themeParams.button_color || '#3390ec');
                document.documentElement.style.setProperty('--tg-theme-button-text-color', themeParams.button_text_color || '#ffffff');
                document.documentElement.style.setProperty('--tg-theme-secondary-bg-color', themeParams.secondary_bg_color || '#f5f5f5');
                document.documentElement.style.setProperty('--tg-theme-section-bg-color', themeParams.section_bg_color || '#ffffff');
                document.documentElement.style.setProperty('--tg-theme-accent-text-color', themeParams.accent_text_color || '#3390ec');
                document.documentElement.style.setProperty('--tg-theme-destructive-text-color', themeParams.destructive_text_color || '#ec3944');
                document.documentElement.style.setProperty('--tg-theme-section-separator-color', themeParams.section_separator_color || '#e0e0e0');
                
                // Set color scheme
                if (themeParams.color_scheme) {
                    document.documentElement.setAttribute('data-theme', themeParams.color_scheme);
                }
            }
        }

        // Tab navigation
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Hide all tab contents
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.add('hidden');
                });
                
                // Show selected tab content
                const tabId = this.getAttribute('data-tab');
                document.getElementById(`${tabId}-content`).classList.remove('hidden');
            });
        });

        // Download functionality
        const downloadLinks = {
            'minecraft': 'https://huggingface.co/Zerchi/cappie_miside/resolve/main/Minecraft.APK',
            'brawlstars': 'https://huggingface.co/Zerchi/cappie_miside/resolve/main/BrawlStars.APK',
            'standoff': 'https://huggingface.co/Zerchi/cappie_miside/resolve/main/Standoff2.APK'
        };

        document.getElementById('minecraft-download').addEventListener('click', () => startDownload('minecraft', 'Minecraft APK', 'Minecraft.APK'));
        document.getElementById('brawlstars-download').addEventListener('click', () => startDownload('brawlstars', 'Brawl Stars APK', 'BrawlStars.APK'));
        document.getElementById('standoff-download').addEventListener('click', () => startDownload('standoff', 'Standoff 2 APK', 'Standoff2.APK'));

        function startDownload(gameId, title, fileName) {
            // Show loader
            document.getElementById('loader').style.display = 'block';
            document.getElementById('progress-bar').style.width = '0%';
            
            if (window.Telegram && Telegram.WebApp && Telegram.WebApp.version && Telegram.WebApp.isVersionAtLeast('8.0')) {
                // Use Telegram's native downloadFile method for Bot API 8.0+
                Telegram.WebApp.downloadFile({
                    url: downloadLinks[gameId],
                    file_name: fileName
                }, function(accepted) {
                    if (accepted) {
                        showNotification('Download started!', false);
                        simulateDownloadProgress();
                    } else {
                        showNotification('Download cancelled by user', true);
                        hideLoader();
                    }
                });
                
                // Handle the fileDownloadRequested event
                Telegram.WebApp.onEvent('fileDownloadRequested', function(data) {
                    console.log('File download requested:', data);
                    if (data.status === 'downloading') {
                        showNotification('Downloading file...', false);
                    } else if (data.status === 'cancelled') {
                        showNotification('Download cancelled', true);
                        hideLoader();
                    }
                });
            } else {
                // Fallback for older versions or non-Telegram environments
                showNotification('Using browser download...', false);
                const link = document.createElement('a');
                link.href = downloadLinks[gameId];
                link.download = fileName;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                hideLoader();
            }
        }

        function simulateDownloadProgress() {
            let progress = 0;
            const progressBar = document.getElementById('progress-bar');
            
            const interval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(() => {
                        hideLoader();
                        showNotification('Download complete!', false);
                    }, 500);
                }
                progressBar.style.width = `${progress}%`;
            }, 300);
        }

        function hideLoader() {
            document.getElementById('loader').style.display = 'none';
        }

        function showNotification(message, isError = false) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            if (isError) {
                notification.classList.add('error');
            } else {
                notification.classList.remove('error');
            }
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Fallback initialization if Telegram WebApp is not available
        if (!window.Telegram || !Telegram.WebApp) {
            console.log('Running in non-Telegram environment, applying default theme');
            // Apply a default theme for testing outside Telegram
            const defaultTheme = {
                bg_color: '#ffffff',
                text_color: '#000000',
                link_color: '#3390ec',
                button_color: '#3390ec',
                button_text_color: '#ffffff',
                secondary_bg_color: '#f5f5f5',
                section_bg_color: '#ffffff',
                accent_text_color: '#3390ec',
                destructive_text_color: '#ec3944',
                section_separator_color: '#e0e0e0',
                color_scheme: 'light'
            };
            applyTheme(defaultTheme);
        }
    </script>
</body>
</html>
