<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enchanted Forest Visual Novel</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            color: #333;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2em;
            transition: opacity 1s ease;
            z-index: 10;
        }

        #menu {
            text-align: center;
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        #menu button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 1.2em;
            cursor: pointer;
        }

        #bottom-left {
            position: absolute;
            bottom: 10px;
            left: 10px;
        }

        #bottom-right {
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            gap: 10px;
        }

        .icon {
            width: 30px;
            height: 30px;
            background-color: #ccc; /* Placeholder for icons */
            cursor: pointer;
            border-radius: 50%;
        }

        #game {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
            box-sizing: border-box;
        }

        #game-text {
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        #choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #choices button {
            padding: 10px;
            font-size: 1em;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="splash" class="overlay">Zerchi Games</div>
    <div id="menu" style="display: none;">
        <button onclick="startGame()">Play</button>
        <button onclick="showSettings()">Settings</button>
        <div id="bottom-left">
            <div class="icon" onclick="openLink('https://www.youtube.com/c/KuplinovPlay')" title="Kuplinov Play"></div>
        </div>
        <div id="bottom-right">
            <div class="icon" onclick="openLink('https://twitter.com/example')" title="Twitter"></div>
            <div class="icon" onclick="openLink('https://instagram.com/example')" title="Instagram"></div>
            <div class="icon" onclick="openLink('https://t.me/example')" title="Telegram"></div>
        </div>
    </div>
    <div id="game" style="display: none;">
        <div id="game-text"></div>
        <div id="choices"></div>
    </div>

    <script>
        const WebApp = window.Telegram.WebApp;
        WebApp.ready();

        // Request fullscreen if not already
        if (!WebApp.isFullscreen) {
            WebApp.requestFullscreen();
        }

        // Lock orientation if not locked (locks to current; assume user starts in portrait)
        if (!WebApp.isOrientationLocked) {
            WebApp.lockOrientation();
        }

        // Start device orientation tracking (optional, for monitoring)
        WebApp.DeviceOrientation.start();

        // Splash screen logic: show for 5 seconds, then fade out
        setTimeout(() => {
            const splash = document.getElementById('splash');
            splash.style.opacity = 0;
            setTimeout(() => {
                splash.style.display = 'none';
                document.getElementById('menu').style.display = 'flex';
            }, 1000); // Fade duration
        }, 5000);

        function openLink(url) {
            WebApp.openLink(url);
        }

        function showSettings() {
            alert('Settings: No options available yet. (e.g., Sound On/Off)');
        }

        function startGame() {
            // Create darkening overlay for menu transition
            const overlay = document.createElement('div');
            overlay.className = 'overlay';
            overlay.style.opacity = 0;
            document.body.appendChild(overlay);
            overlay.style.opacity = 1; // Fade in
            setTimeout(() => {
                document.getElementById('menu').style.display = 'none';
                overlay.remove();
                document.getElementById('game').style.display = 'flex';
                renderScene('start');
            }, 1000); // Fade duration
        }

        // Mini scenario: "Lost in the Enchanted Forest"
        // Simple branching story with choices and endings.
        const scenes = {
            start: {
                text: "You wake up in a dense, enchanted forest. The trees seem to whisper secrets, and mist swirls around your feet. Ahead, the path splits: one trail leads left into shadowy woods, the other right toward a faint glow.",
                choices: [
                    { text: "Go left into the shadows", next: "left" },
                    { text: "Go right toward the glow", next: "right" }
                ]
            },
            left: {
                text: "As you venture left, you stumble upon a rushing river blocking your path. The water looks deep, but you spot a rickety bridge. Alternatively, you could follow the riverbank upstream.",
                choices: [
                    { text: "Cross the bridge", next: "cross" },
                    { text: "Follow the riverbank", next: "follow" }
                ]
            },
            right: {
                text: "Heading right, you encounter a snarling wolf guarding a clearing. It eyes you warily. Do you try to run past it or stand your ground and attempt to befriend it?",
                choices: [
                    { text: "Run past the wolf", next: "run" },
                    { text: "Stand ground and befriend", next: "befriend" }
                ]
            },
            cross: {
                text: "You cautiously cross the bridge, but it collapses midway! You fall into the river and are swept away, eventually washing up in a distant village. You've escaped the forest, but with a few bruises. THE END.",
                choices: []
            },
            follow: {
                text: "Following the riverbank leads you to a hidden waterfall with a cave behind it. Inside, you find a treasure chest filled with gold and a map out of the forest. Success! THE END.",
                choices: []
            },
            run: {
                text: "You dash past the wolf, but it chases you relentlessly. Exhausted, you trip and fall, and the wolf catches up. Unfortunately, this is the end of your adventure. THE END.",
                choices: []
            },
            befriend: {
                text: "Standing your ground, you speak softly to the wolf. Miraculously, it calms down and guides you through the clearing to a safe exit from the forest. You've made a new friend! THE END.",
                choices: []
            }
        };

        function renderScene(sceneId) {
            const scene = scenes[sceneId];
            if (!scene) return;

            document.getElementById('game-text').innerText = scene.text;
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '';

            scene.choices.forEach(choice => {
                const button = document.createElement('button');
                button.innerText = choice.text;
                button.onclick = () => renderScene(choice.next);
                choicesDiv.appendChild(button);
            });

            if (scene.choices.length === 0) {
                const restartButton = document.createElement('button');
                restartButton.innerText = 'Restart';
                restartButton.onclick = () => renderScene('start');
                choicesDiv.appendChild(restartButton);
            }
        }
    </script>
</body>
</html>
